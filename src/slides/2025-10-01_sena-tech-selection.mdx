export const metadata = {
  title: "技術選定はしっかりやろう - 個人開発から学んだ教訓",
  author: "sena-m09",
};

<div className="slide">

# 技術選定はしっかりやろう

## 個人開発から学んだ教訓

</div>

---

<div className="slide">

## 自己紹介

- **名前**: 村上 世南
- **好きなもの**:
  - 趣味：寝ること
  - 休日の過ごし方：たくさん寝る

</div>

---

<div className="slide">

## プロジェクト紹介

バドミントンサークルのアプリを開発

### 技術スタック

- **フロントエンド**: React Router, Vite, shadcn/ui
- **バックエンド**: Cloudflare Workers, Supabase
- **認証**: Clerk
- **その他**: zod, neverthrow, Storybook

</div>

---

<div className="slide">

## アーキテクチャ

<img src="/2025-10-01_sena-tech-selection/architecture.png" alt="システムアーキテクチャ図" style={{width: "700px", margin: "20px auto", display: "block"}} />

</div>

---

<div className="slide">

## 技術選定のメリット・デメリット

### Cloudflare Workers

**メリット**
- 低レイテンシー、ある程度無料
- ドメイン設定が楽、他サービスとの連携

**デメリット**
- 環境変数の取り扱いが特殊
- サポートされていないNode.jsライブラリが多い（Prisma非対応など）

</div>

---

<div className="slide">

## 技術選定のメリット・デメリット

### React Router

**メリット**
- ビルドが早い
- Web標準の動きで理解しやすい

**デメリット**
- Next.jsに比べて情報が少ない
- 環境変数の使い方が特殊

</div>

---

<div className="slide">

## 技術選定のメリット・デメリット

### Supabase

**メリット**
- ある程度無料でできる

**デメリット**
- 無料プランだとDB停止される
- Edge FunctionsがDeno
- 情報が少ない or 古い

</div>

---

<div className="slide">

## 技術選定のメリット・デメリット

### Clerk

**メリット**
- 無料でドメイン設定可能
- LINE認証が簡単、ダッシュボードが見やすい
- Supabaseとの連携がしやすい

**デメリット**
- 細かい困りポイントの解決法が見つからない
- ソースコード読むことも

</div>

---

<div className="slide">

## 起きた問題

### デプロイ後にClerkの`getAuth()`が動作しない

- ローカルでは正常に動作していた
- 本番環境でのみエラーが発生
- **原因特定に時間がかかった**

</div>

---

<div className="slide">

## 原因は環境変数の優先度

### 環境変数の読み込み優先度

**Viteの環境変数 > Cloudflareの環境変数**

- `getAuth()`内でViteの環境変数が優先された
- ローカルでは`.dev.vars`が動いていたので気づけなかった
- 本番環境ではCloudflareの環境変数を参照すべきだった

</div>

---

<div className="slide">

## 解決方法

### GitHub Actionsからデプロイ

- `.dev.vars`はgitignoreされている
- GitHub Actionsからデプロイすることで、ローカル用の環境変数は含まれない
- 本番環境用の環境変数のみを参照するようになった

</div>

---

<div className="slide">

## 得られた教訓

### 1. ローカルと本番で動作が変わる可能性を想定しよう

- 環境変数の優先順位を理解する
- ローカルで動いても本番で動かないことがある

### 2. 最初からCI/CDでデプロイする仕組みを作ろう

- 早い段階で本番と同じ環境でテストできる
- 問題の早期発見につながる

</div>

---

<div className="slide">

## まとめ

### 技術選定はしっかりやろう

- **各技術のメリット・デメリットを理解する**
- **環境の違い（ローカル vs 本番）も考慮する**
- **早めにCI/CD環境を整える**

技術選定は開発の基盤。慎重に、そして早めに検証しながら進めることで、後の苦労を減らせます。

ぜひ次のプロジェクトでは、これらのポイントを意識してみてください！

</div>
